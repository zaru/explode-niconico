<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title></title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="//code.jquery.com/jquery-3.1.0.min.js"></script>
  <script src="jquery.imgexplode.min.js"></script>
  <style type="text/css">
  html, body {
    height: 100%;
  }
  div {
    cursor: pointer;
  }
  </style>
</head>
<body>
  <div id="test" style='font-size:40px;position:fixed;'>
    <em>I</em> like <span style='color:white; text-shadow:0 0 2px blue;'>cheese</span>
  </div>
  <br>
  <!-- <canvas id="cv"></canvas> -->
  <!-- <img id="mock" src=""> -->
  <!-- <img id="image_png" src=""> -->
  <script>
  $(document).on('click', 'div', function(e) {
    if ($(this).css('position') == 'fixed') {
      targetDom($(this), {x: e.pageX, y: e.pageY})
    }
  })
  function targetDom(dom, position) {
    var domHtml = dom.prop('outerHTML')
    var domWidth = dom.width()
    var domHeight = dom.height()
    domHtml = domHtml.replace(/(left|top):\s*[0-9]+px/g, "")
    console.log(domHtml)

    var data = `<svg xmlns='http://www.w3.org/2000/svg' width='${domWidth}' height='${domHeight}'>` +
                 "<foreignObject width='100%' height='100%'>" +
                   "<div xmlns='http://www.w3.org/1999/xhtml'>" +
                     domHtml +
                   "</div>" +
                 "</foreignObject>" +
               "</svg>"
    var DOMURL = self.URL || self.webkitURL || self
    var svg = new Blob([data], {type: "image/svg+xml;charset=utf-8"})
    var url = DOMURL.createObjectURL(svg)

    dom.hide()

    var img = $('<img>')
    img.css('position', 'fixed')
    img.css('top', position.y + 'px')
    img.css('left', position.x + 'px')
    img.attr('src', url)
    console.log(url)
    $('body').append(img)

    console.log(position)

    img.explode({
      "minWidth":3,"maxWidth":12,"radius":235,"minRadius":15,
      "release":false,"fadeTime":300,"recycle":false,
      "recycleDelay":500,"explodeTime":231,"round":false,
      "minAngle":0,"maxAngle":360,"gravity":10,"groundDistance":1000
    })
  }
  </script>
</body>
</html>
